# üõ°Ô∏è AutoPay: Webhook Security & Analytics

AutoPay ‚Äî —Ü–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø –≤–∏—Å–æ–∫–æ–Ω–∞–¥—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –æ–±—Ä–æ–±–∫–∏ –ø–ª–∞—Ç–µ–∂—ñ–≤, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –∑ –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –±–µ–∑–ø–µ–∫—É, —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é –∑–≤—ñ—Ç–Ω–æ—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AI.

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- **FastAPI Backend**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –∑ –≤–∏—Å–æ–∫–æ—é –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é.
- **HMAC Authentication**: –ö–æ–∂–µ–Ω Webhook –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ü–∏—Ñ—Ä–æ–≤–∏–º –ø—ñ–¥–ø–∏—Å–æ–º –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ —Ñ–µ–π–∫–æ–≤–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.
- **Idempotency Guard**: –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–¥–≤—ñ–π–Ω–æ–≥–æ —Å–ø–∏—Å–∞–Ω–Ω—è –≥—Ä–æ—à–µ–π (–∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä–Ω—ñ–π –æ–±—Ä–æ–±—Ü—ñ –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ —Å–∞–º–æ–≥–æ `tx_id`).
- **Beanie ODM (MongoDB)**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –æ–±'—î–∫—Ç–Ω–æ-–¥–æ–∫—É–º–µ–Ω—Ç–Ω–æ–≥–æ –º–∞–ø—ñ–Ω–≥—É.
- **AI-Powered Insights**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –±—ñ–∑–Ω–µ—Å-–∑–≤—ñ—Ç—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Google Gemini API**.
- **Mock Simulator**: –í–±—É–¥–æ–≤–∞–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É (—É—Å–ø—ñ—à–Ω—ñ –ø–ª–∞—Ç–µ–∂—ñ, –∞—Ç–∞–∫–∏, –¥—É–±–ª—ñ–∫–∞—Ç–∏).

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

- **–ú–æ–≤–∞**: Python 3.11+ (async/await)
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: FastAPI
- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö**: MongoDB + Beanie ODM
- **–ë–µ–∑–ø–µ–∫–∞**: HMAC (SHA256)
- **AI**: Google Generative AI (Gemini)
- **QA**: Pytest

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```text
app/
‚îú‚îÄ‚îÄ main.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É FastAPI: —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è, —Ä–æ—É—Ç–∏, –º—ñ–¥–ª–≤–∞—Ä–∏
‚îú‚îÄ‚îÄ database.py      # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MongoDB (Beanie ODM)
‚îú‚îÄ‚îÄ models.py        # –°—Ö–µ–º–∏ –¥–∞–Ω–∏—Ö: Pydantic (API) —Ç–∞ Beanie (–ë–î)
‚îú‚îÄ‚îÄ security.py      # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—è: –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ HMAC-–ø—ñ–¥–ø–∏—Å—ñ–≤ –¥–ª—è Webhooks
‚îî‚îÄ‚îÄ services/        # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞: –æ–±—Ä–æ–±–∫–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤ —Ç–∞ —Å–µ—Ä–≤—ñ—Å–Ω–∏–π —à–∞—Ä

scripts/
‚îú‚îÄ‚îÄ mock_sender.py   # –°–∏–º—É–ª—è—Ç–æ—Ä –ø–ª–∞—Ç—ñ–∂–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ (HMAC, —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å)
‚îî‚îÄ‚îÄ ai_reporter.py   # AI-–ê–Ω–∞–ª—ñ—Ç–∏–∫: –∑–≤—ñ—Ç–∏ —á–µ—Ä–µ–∑ Google Gemini API

tests/
‚îî‚îÄ‚îÄ test_webhooks.py # Pytest: —Ç–µ—Å—Ç–∏ –Ω–∞ –±–µ–∑–ø–µ–∫—É —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é

.env                 # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è: –∫–ª—é—á—ñ API, —Å–µ–∫—Ä–µ—Ç–∏ —Ç–∞ –¥–æ—Å—Ç—É–ø–∏